:root {
    --card-height: 25vh; 
    --card-width: calc(var(--card-height) * 145 / 210); 
    
    --card-x: 0px;
    --card-y: 0px;
    --drag-rot-z: 0deg; 
    --mouse-rot-z: 0deg; 
}

body {
    background-color: #333; 
    display: block;
    margin: 0; 
    height: 100vh; 
    width: 100vw;
    perspective: 1000px;
    overflow: hidden;
    position: relative;
}

#grid-container {
    position: absolute;
    top: 50%; 
    left: 50%; 
    transform: translate(-50%, -50%); 
    width: calc(3 * var(--card-width)); 
    height: calc(4 * var(--card-height)); 
}

.card-container {
    position: absolute;
    width: var(--card-width);
    height: var(--card-height);
    cursor: pointer;
    transform-style: preserve-3d;
    
    /* ❗ 안정화: 위치 이동 트랜지션 (튕겨나가기 물리 효과를 위해 추가된 복잡한 트랜지션 제거) */
    transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94); 
    
    transform: translate(var(--card-x), var(--card-y)) rotateZ(var(--drag-rot-z)); 
}

.card-inner {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    
    /* 뒤집기 모션 속도: 느리고 확실하게 */
    transition: transform 1.0s cubic-bezier(0.4, 0.2, 0, 1.25); 
}

.card-container.is-flipped .card-inner {
    transform: rotateY(180deg);
}

.card-face {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden; 
    
    background-size: cover;
    background-position: center;
    transition: box-shadow 0.2s ease;
}

.card-back {
    transform: rotateY(180deg) translateZ(1px); 
}

/* 드래그 중 회전 효과만 유지 */
.card-container.is-dragging {
    transition: none; 
    z-index: 1000 !important; 
    cursor: grabbing;
    /* 그림자 제거 유지 */
    transform: translate(var(--card-x), var(--card-y)) rotateZ(var(--drag-rot-z)); 
}

.card-container.is-dragging .card-face {
    opacity: 1; 
}

/* 마우스 무브/호버 효과 관련 CSS 제거 */
.card-container.is-moved {
    transform: translate(var(--card-x), var(--card-y)) rotateZ(0deg); 
    transition: none; 
}


#reset-button {
    position: fixed;
    bottom: 20px;
    right: 20px;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    z-index: 2000;
}